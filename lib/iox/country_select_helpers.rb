# encoding: utf-8
# CountrySelect
module Iox
  module Helpers
    module CountrySelectHelper

      def self.countries 
        {
        de: [["Afghanistan", "af"], ["Alandinseln", "ax"], ["Albanien", "al"], ["Algerien", "dz"], ["Amerikanisch-Ozeanien", "um"], ["Amerikanisch-Samoa", "as"], ["Amerikanische Jungferninseln", "vi"], ["Andorra", "ad"], ["Angola", "ao"], ["Anguilla", "ai"], ["Antarktis", "aq"], ["Antigua und Barbuda", "ag"], ["Argentinien", "ar"], ["Armenien", "am"], ["Aruba", "aw"], ["Aserbaidschan", "az"], ["Australien", "au"], ["Bahamas", "bs"], ["Bahrain", "bh"], ["Bangladesch", "bd"], ["Barbados", "bb"], ["Belarus", "by"], ["Belgien", "be"], ["Belize", "bz"], ["Benin", "bj"], ["Bermuda", "bm"], ["Bhutan", "bt"], ["Bolivien", "bo"], ["Bosnien und Herzegowina", "ba"], ["Botsuana", "bw"], ["Bouvetinsel", "bv"], ["Brasilien", "br"], ["Britische Jungferninseln", "vg"], ["Britisches Territorium im Indischen Ozean", "io"], ["Brunei Darussalam", "bn"], ["Bulgarien", "bg"], ["Burkina Faso", "bf"], ["Burundi", "bi"], ["Chile", "cl"], ["China", "cn"], ["Cookinseln", "ck"], ["Costa Rica", "cr"], ["Côte d’Ivoire", "ci"], ["Demokratische Republik Kongo", "cd"], ["Demokratische Volksrepublik Korea", "kp"], ["Deutschland", "de"], ["Dominica", "dm"], ["Dominikanische Republik", "do"], ["Dschibuti", "dj"], ["Dänemark", "dk"], ["Ecuador", "ec"], ["El Salvador", "sv"], ["Eritrea", "er"], ["Estland", "ee"], ["Falklandinseln", "fk"], ["Fidschi", "fj"], ["Finnland", "fi"], ["Frankreich", "fr"], ["Französisch-Guayana", "gf"], ["Französisch-Polynesien", "pf"], ["Französische Süd- und Antarktisgebiete", "tf"], ["Färöer", "fo"], ["Gabun", "ga"], ["Gambia", "gm"], ["Georgien", "ge"], ["Ghana", "gh"], ["Gibraltar", "gi"], ["Grenada", "gd"], ["Griechenland", "gr"], ["Grönland", "gl"], ["Guadeloupe", "gp"], ["Guam", "gu"], ["Guatemala", "gt"], ["Guernsey", "gg"], ["Guinea", "gn"], ["Guinea-Bissau", "gw"], ["Guyana", "gy"], ["Haiti", "ht"], ["Heard- und McDonald-Inseln", "hm"], ["Honduras", "hn"], ["Indien", "in"], ["Indonesien", "id"], ["Irak", "iq"], ["Iran", "ir"], ["Irland", "ie"], ["Island", "is"], ["Isle of Man", "im"], ["Israel", "il"], ["Italien", "it"], ["Jamaika", "jm"], ["Japan", "jp"], ["Jemen", "ye"], ["Jersey", "je"], ["Jordanien", "jo"], ["Kaimaninseln", "ky"], ["Kambodscha", "kh"], ["Kamerun", "cm"], ["Kanada", "ca"], ["Kap Verde", "cv"], ["Kasachstan", "kz"], ["Katar", "qa"], ["Kenia", "ke"], ["Kirgisistan", "kg"], ["Kiribati", "ki"], ["Kokosinseln", "cc"], ["Kolumbien", "co"], ["Komoren", "km"], ["Kongo", "cg"], ["Kroatien", "hr"], ["Kuba", "cu"], ["Kuwait", "kw"], ["Laos", "la"], ["Lesotho", "ls"], ["Lettland", "lv"], ["Libanon", "lb"], ["Liberia", "lr"], ["Libyen", "ly"], ["Liechtenstein", "li"], ["Litauen", "lt"], ["Luxemburg", "lu"], ["Madagaskar", "mg"], ["Malawi", "mw"], ["Malaysia", "my"], ["Malediven", "mv"], ["Mali", "ml"], ["Malta", "mt"], ["Marokko", "ma"], ["Marshallinseln", "mh"], ["Martinique", "mq"], ["Mauretanien", "mr"], ["Mauritius", "mu"], ["Mayotte", "yt"], ["Mazedonien", "mk"], ["Mexiko", "mx"], ["Mikronesien", "fm"], ["Monaco", "mc"], ["Mongolei", "mn"], ["Montenegro", "me"], ["Montserrat", "ms"], ["Mosambik", "mz"], ["Myanmar", "mm"], ["Namibia", "na"], ["Nauru", "nr"], ["Nepal", "np"], ["Neukaledonien", "nc"], ["Neuseeland", "nz"], ["Nicaragua", "ni"], ["Niederlande", "nl"], ["Niederländische Antillen", "an"], ["Niger", "ne"], ["Nigeria", "ng"], ["Niue", "nu"], ["Norfolkinsel", "nf"], ["Norwegen", "no"], ["Nördliche Marianen", "mp"], ["Oman", "om"], ["Osttimor", "tl"], ["Pakistan", "pk"], ["Palau", "pw"], ["Palästinensische Gebiete", "ps"], ["Panama", "pa"], ["Papua-Neuguinea", "pg"], ["Paraguay", "py"], ["Peru", "pe"], ["Philippinen", "ph"], ["Pitcairn", "pn"], ["Polen", "pl"], ["Portugal", "pt"], ["Puerto Rico", "pr"], ["Republik Korea", "kr"], ["Republik Moldau", "md"], ["Ruanda", "rw"], ["Rumänien", "ro"], ["Russische Föderation", "ru"], ["Réunion", "re"], ["Salomonen", "sb"], ["Sambia", "zm"], ["Samoa", "ws"], ["San Marino", "sm"], ["Saudi-Arabien", "sa"], ["Schweden", "se"], ["Schweiz", "ch"], ["Senegal", "sn"], ["Serbien", "rs"], ["Serbien und Montenegro", "cs"], ["Seychellen", "sc"], ["Sierra Leone", "sl"], ["Simbabwe", "zw"], ["Singapur", "sg"], ["Slowakei", "sk"], ["Slowenien", "si"], ["Somalia", "so"], ["Sonderverwaltungszone Hongkong", "hk"], ["Sonderverwaltungszone Macao", "mo"], ["Spanien", "es"], ["Sri Lanka", "lk"], ["St. Barthélemy", "bl"], ["St. Helena", "sh"], ["St. Kitts und Nevis", "kn"], ["St. Lucia", "lc"], ["St. Martin", "mf"], ["St. Pierre und Miquelon", "pm"], ["St. Vincent und die Grenadinen", "vc"], ["Sudan", "sd"], ["Suriname", "sr"], ["Svalbard und Jan Mayen", "sj"], ["Swasiland", "sz"], ["Syrien", "sy"], ["São Tomé und Príncipe", "st"], ["Südafrika", "za"], ["Südgeorgien und die Südlichen Sandwichinseln", "gs"], ["Tadschikistan", "tj"], ["Taiwan", "tw"], ["Tansania", "tz"], ["Thailand", "th"], ["Togo", "tg"], ["Tokelau", "tk"], ["Tonga", "to"], ["Trinidad und Tobago", "tt"], ["Tschad", "td"], ["Tschechische Republik", "cz"], ["Tunesien", "tn"], ["Turkmenistan", "tm"], ["Turks- und Caicosinseln", "tc"], ["Tuvalu", "tv"], ["Türkei", "tr"], ["Uganda", "ug"], ["Ukraine", "ua"], ["Unbekannte oder ungültige Region", "zz"], ["Ungarn", "hu"], ["Uruguay", "uy"], ["Usbekistan", "uz"], ["Vanuatu", "vu"], ["Vatikanstadt", "va"], ["Venezuela", "ve"], ["Vereinigte Arabische Emirate", "ae"], ["Vereinigte Staaten", "us"], ["Vereinigtes Königreich", "gb"], ["Vietnam", "vn"], ["Wallis und Futuna", "wf"], ["Weihnachtsinsel", "cx"], ["Westsahara", "eh"], ["Zentralafrikanische Republik", "cf"], ["Zypern", "cy"], ["Ägypten", "eg"], ["Äquatorialguinea", "gq"], ["Äthiopien", "et"], ["Österreich", "at"]],
        en: [["Afghanistan", "af"], ["Albania", "al"], ["Algeria", "dz"], ["American Samoa", "as"], ["Andorra", "ad"], ["Angola", "ao"], ["Anguilla", "ai"], ["Antarctica", "aq"], ["Antigua and Barbuda", "ag"], ["Argentina", "ar"], ["Armenia", "am"], ["Aruba", "aw"], ["Australia", "au"], ["Austria", "at"], ["Azerbaijan", "az"], ["Bahamas", "bs"], ["Bahrain", "bh"], ["Bangladesh", "bd"], ["Barbados", "bb"], ["Belarus", "by"], ["Belgium", "be"], ["Belize", "bz"], ["Benin", "bj"], ["Bermuda", "bm"], ["Bhutan", "bt"], ["Bolivia", "bo"], ["Bosnia and Herzegovina", "ba"], ["Botswana", "bw"], ["Bouvet Island", "bv"], ["Brazil", "br"], ["British Antarctic Territory", "bq"], ["British Indian Ocean Territory", "io"], ["British Virgin Islands", "vg"], ["Brunei", "bn"], ["Bulgaria", "bg"], ["Burkina Faso", "bf"], ["Burundi", "bi"], ["Cambodia", "kh"], ["Cameroon", "cm"], ["Canada", "ca"], ["Canton and Enderbury Islands", "ct"], ["Cape Verde", "cv"], ["Cayman Islands", "ky"], ["Central African Republic", "cf"], ["Chad", "td"], ["Chile", "cl"], ["China", "cn"], ["Christmas Island", "cx"], ["Cocos [Keeling] Islands", "cc"], ["Colombia", "co"], ["Comoros", "km"], ["Congo - Brazzaville", "cg"], ["Congo - Kinshasa", "cd"], ["Cook Islands", "ck"], ["Costa Rica", "cr"], ["Croatia", "hr"], ["Cuba", "cu"], ["Cyprus", "cy"], ["Czech Republic", "cz"], ["Côte d’Ivoire", "ci"], ["Denmark", "dk"], ["Djibouti", "dj"], ["Dominica", "dm"], ["Dominican Republic", "do"], ["Dronning Maud Land", "nq"], ["East Germany", "dd"], ["Ecuador", "ec"], ["Egypt", "eg"], ["El Salvador", "sv"], ["Equatorial Guinea", "gq"], ["Eritrea", "er"], ["Estonia", "ee"], ["Ethiopia", "et"], ["Falkland Islands", "fk"], ["Faroe Islands", "fo"], ["Fiji", "fj"], ["Finland", "fi"], ["France", "fr"], ["French Guiana", "gf"], ["French Polynesia", "pf"], ["French Southern Territories", "tf"], ["French Southern and Antarctic Territories", "fq"], ["Gabon", "ga"], ["Gambia", "gm"], ["Georgia", "ge"], ["Germany", "de"], ["Ghana", "gh"], ["Gibraltar", "gi"], ["Greece", "gr"], ["Greenland", "gl"], ["Grenada", "gd"], ["Guadeloupe", "gp"], ["Guam", "gu"], ["Guatemala", "gt"], ["Guernsey", "gg"], ["Guinea", "gn"], ["Guinea-Bissau", "gw"], ["Guyana", "gy"], ["Haiti", "ht"], ["Heard Island and McDonald Islands", "hm"], ["Honduras", "hn"], ["Hong Kong SAR China", "hk"], ["Hungary", "hu"], ["Iceland", "is"], ["India", "in"], ["Indonesia", "id"], ["Iran", "ir"], ["Iraq", "iq"], ["Ireland", "ie"], ["Isle of Man", "im"], ["Israel", "il"], ["Italy", "it"], ["Jamaica", "jm"], ["Japan", "jp"], ["Jersey", "je"], ["Johnston Island", "jt"], ["Jordan", "jo"], ["Kazakhstan", "kz"], ["Kenya", "ke"], ["Kiribati", "ki"], ["Kuwait", "kw"], ["Kyrgyzstan", "kg"], ["Laos", "la"], ["Latvia", "lv"], ["Lebanon", "lb"], ["Lesotho", "ls"], ["Liberia", "lr"], ["Libya", "ly"], ["Liechtenstein", "li"], ["Lithuania", "lt"], ["Luxembourg", "lu"], ["Macau SAR China", "mo"], ["Macedonia", "mk"], ["Madagascar", "mg"], ["Malawi", "mw"], ["Malaysia", "my"], ["Maldives", "mv"], ["Mali", "ml"], ["Malta", "mt"], ["Marshall Islands", "mh"], ["Martinique", "mq"], ["Mauritania", "mr"], ["Mauritius", "mu"], ["Mayotte", "yt"], ["Metropolitan France", "fx"], ["Mexico", "mx"], ["Micronesia", "fm"], ["Midway Islands", "mi"], ["Moldova", "md"], ["Monaco", "mc"], ["Mongolia", "mn"], ["Montenegro", "me"], ["Montserrat", "ms"], ["Morocco", "ma"], ["Mozambique", "mz"], ["Myanmar [Burma]", "mm"], ["Namibia", "na"], ["Nauru", "nr"], ["Nepal", "np"], ["Netherlands", "nl"], ["Netherlands Antilles", "an"], ["Neutral Zone", "nt"], ["New Caledonia", "nc"], ["New Zealand", "nz"], ["Nicaragua", "ni"], ["Niger", "ne"], ["Nigeria", "ng"], ["Niue", "nu"], ["Norfolk Island", "nf"], ["North Korea", "kp"], ["North Vietnam", "vd"], ["Northern Mariana Islands", "mp"], ["Norway", "no"], ["Oman", "om"], ["Pacific Islands Trust Territory", "pc"], ["Pakistan", "pk"], ["Palau", "pw"], ["Palestinian Territories", "ps"], ["Panama", "pa"], ["Panama Canal Zone", "pz"], ["Papua New Guinea", "pg"], ["Paraguay", "py"], ["People's Democratic Republic of Yemen", "yd"], ["Peru", "pe"], ["Philippines", "ph"], ["Pitcairn Islands", "pn"], ["Poland", "pl"], ["Portugal", "pt"], ["Puerto Rico", "pr"], ["Qatar", "qa"], ["Romania", "ro"], ["Russia", "ru"], ["Rwanda", "rw"], ["Réunion", "re"], ["Saint Barthélemy", "bl"], ["Saint Helena", "sh"], ["Saint Kitts and Nevis", "kn"], ["Saint Lucia", "lc"], ["Saint Martin", "mf"], ["Saint Pierre and Miquelon", "pm"], ["Saint Vincent and the Grenadines", "vc"], ["Samoa", "ws"], ["San Marino", "sm"], ["Saudi Arabia", "sa"], ["Senegal", "sn"], ["Serbia", "rs"], ["Serbia and Montenegro", "cs"], ["Seychelles", "sc"], ["Sierra Leone", "sl"], ["Singapore", "sg"], ["Slovakia", "sk"], ["Slovenia", "si"], ["Solomon Islands", "sb"], ["Somalia", "so"], ["South Africa", "za"], ["South Georgia and the South Sandwich Islands", "gs"], ["South Korea", "kr"], ["Spain", "es"], ["Sri Lanka", "lk"], ["Sudan", "sd"], ["Suriname", "sr"], ["Svalbard and Jan Mayen", "sj"], ["Swaziland", "sz"], ["Sweden", "se"], ["Switzerland", "ch"], ["Syria", "sy"], ["São Tomé and Príncipe", "st"], ["Taiwan", "tw"], ["Tajikistan", "tj"], ["Tanzania", "tz"], ["Thailand", "th"], ["Timor-Leste", "tl"], ["Togo", "tg"], ["Tokelau", "tk"], ["Tonga", "to"], ["Trinidad and Tobago", "tt"], ["Tunisia", "tn"], ["Turkey", "tr"], ["Turkmenistan", "tm"], ["Turks and Caicos Islands", "tc"], ["Tuvalu", "tv"], ["U.S. Minor Outlying Islands", "um"], ["U.S. Miscellaneous Pacific Islands", "pu"], ["U.S. Virgin Islands", "vi"], ["Uganda", "ug"], ["Ukraine", "ua"], ["Union of Soviet Socialist Republics", "su"], ["United Arab Emirates", "ae"], ["United Kingdom", "gb"], ["United States", "us"], ["Unknown or Invalid Region", "zz"], ["Uruguay", "uy"], ["Uzbekistan", "uz"], ["Vanuatu", "vu"], ["Vatican City", "va"], ["Venezuela", "ve"], ["Vietnam", "vn"], ["Wake Island", "wk"], ["Wallis and Futuna", "wf"], ["Western Sahara", "eh"], ["Yemen", "ye"], ["Zambia", "zm"], ["Zimbabwe", "zw"], ["Åland Islands", "ax"]]
      }
      end

      # Return select and option tags for the given object and method, using country_options_for_select to generate the list of option tags.
      def country_select(object, method, priority_countries = nil, options = {}, html_options = {})
        InstanceTag.new(object, method, self, options.delete(:object)).to_country_select_tag(priority_countries, options, html_options)
      end
      # Returns a string of option tags for pretty much any country in the world. Supply a country name as +selected+ to
      # have it marked as the selected option tag. You can also supply an array of countries as +priority_countries+, so
      # that they will be listed above the rest of the (long) list.
      #
      # NOTE: Only the option tags are returned, you have to wrap this call in a regular HTML select tag.
      def country_options_for_select(selected = nil, priority_countries = nil)
        country_options = ""

        if priority_countries
          country_options += options_for_select(priority_countries, selected)
          country_options += "<option value=\"\" disabled=\"disabled\">-------------</option>\n"
          # prevents selected from being included twice in the HTML which causes
          # some browsers to select the second selected option (not priority)
          # which makes it harder to select an alternative priority country
          selected=nil if priority_countries.include?(selected)
        end

        return country_options + options_for_select(Iox::Helpers::CountrySelectHelper::countries[I18n.locale.to_sym], selected)
      end
      # All the countries included in the country_options output.
    end

    class InstanceTag
      def to_country_select_tag(priority_countries, options, html_options)
        html_options = html_options.stringify_keys
        add_default_name_and_id(html_options)
        value = value(object)
        content_tag("select",
          add_options(
            country_options_for_select(value, priority_countries),
            options, value
          ), html_options
        )
      end
    end

    class FormBuilder
      def country_select(method, priority_countries = nil, options = {}, html_options = {})
        @template.country_select(@object_name, method, priority_countries, options.merge(:object => @object), html_options)
      end
    end
  end
end
